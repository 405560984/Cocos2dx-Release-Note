<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Cocos2d-x v3.4 英文发布说明 | Cocos2d-x 版本发布说明</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.5.0">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
        
    
    
    <link rel="next" href="./cocos2d-x_v3.5_release_notes.html" />
    
    
    <link rel="prev" href="./cocos2d-x_v3.4_release_notes.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="gitbook/style.css">


        
    <div class="book" data-level="2.10" data-basepath="." data-revision="1435215678496">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="cocos2d-x_release_notes.html">
            
                
                    <a href="./cocos2d-x_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Cocos2d-x 版本发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="cocos2d-x_v3.x_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.x_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Cocos2d-x v3.x 系列
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="cocos2d-x_v3.0_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.0_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         Cocos2d-x v3.0 中文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2" data-path="cocos2d-x_v3.0_release_notes_en.html">
            
                
                    <a href="./cocos2d-x_v3.0_release_notes_en.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Cocos2d-x v3.0 英文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="cocos2d-x_v3.1_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.1_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                         Cocos2d-x v3.1 中文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4" data-path="cocos2d-x_v3.1_release_notes_en.html">
            
                
                    <a href="./cocos2d-x_v3.1_release_notes_en.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                         Cocos2d-x v3.1 英文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.5" data-path="cocos2d-x_v3.2_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.2_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                         Cocos2d-x v3.2 中文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.6" data-path="cocos2d-x_v3.2_release_notes_en.html">
            
                
                    <a href="./cocos2d-x_v3.2_release_notes_en.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                         Cocos2d-x v3.2 英文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.7" data-path="cocos2d-x_v3.3_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.3_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                         Cocos2d-x v3.3 中文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.8" data-path="cocos2d-x_v3.3_release_notes_en.html">
            
                
                    <a href="./cocos2d-x_v3.3_release_notes_en.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                         Cocos2d-x v3.3 英文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.9" data-path="cocos2d-x_v3.4_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.4_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.9.</b>
                        
                         Cocos2d-x v3.4 中文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="2.10" data-path="cocos2d-x_v3.4_release_notes_en.html">
            
                
                    <a href="./cocos2d-x_v3.4_release_notes_en.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.10.</b>
                        
                         Cocos2d-x v3.4 英文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.11" data-path="cocos2d-x_v3.5_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.5_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.11.</b>
                        
                         Cocos2d-x v3.5 中文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.12" data-path="cocos2d-x_v3.5_release_notes_en.html">
            
                
                    <a href="./cocos2d-x_v3.5_release_notes_en.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.12.</b>
                        
                         Cocos2d-x v3.5 英文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.13" data-path="cocos2d-x_v3.6_release_notes.html">
            
                
                    <a href="./cocos2d-x_v3.6_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.13.</b>
                        
                         Cocos2d-x v3.6 中文发布说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.14" data-path="cocos2d-x_v3.6_release_notes_en.html">
            
                
                    <a href="./cocos2d-x_v3.6_release_notes_en.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.14.</b>
                        
                         Cocos2d-x v3.6 英文发布说明
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="cocos2d-x_v4.x_release_notes.html">
            
                
                    <a href="./cocos2d-x_v4.x_release_notes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Cocos2d-x v4.x 系列
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Cocos2d-x 版本发布说明</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_12">
                    
                        <h1 id="cocos2d-x-v34-release-notes">cocos2d-x v3.4 Release Notes</h1>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<p><strong>Table of Contents</strong>  <em>generated with <a href="https://github.com/thlorenz/doctoc" target="_blank">DocToc</a></em></p>
<ul>
<li><a href="#misc-information">Misc Information</a></li>
<li><a href="#requirements">Requirements</a><ul>
<li><a href="#runtime-requirements">Runtime Requirements</a></li>
<li><a href="#compiler-requirements">Compiler Requirements</a></li>
<li><a href="#how-to-run-tests">How to run tests</a><ul>
<li><a href="#mac-osx-&amp;-ios">Mac OSX &amp; iOS</a></li>
<li><a href="#android">Android</a></li>
<li><a href="#windows">Windows</a></li>
<li><a href="#linux">Linux</a></li>
</ul>
</li>
<li><a href="#how-to-start-a-new-game">How to start a new game</a></li>
</ul>
</li>
<li><a href="#v34">v3.4</a><ul>
<li><a href="#bugs-fixed-in-v34">Bugs fixed in v3.4</a></li>
</ul>
</li>
<li><a href="#v34rc1">v3.4rc1</a><ul>
<li><a href="#highlights-of-v34rc1">Highlights of v3.4rc1</a></li>
<li><a href="#features-in-detail">Features in detail</a><ul>
<li><a href="#3d-rendering-support-for-2d-objects">3D rendering support for 2D objects</a></li>
<li><a href="#culling-is-now-an-options-by-cc_use_culling-macro">Culling is now an options by CC_USE_CULLING macro</a></li>
</ul>
</li>
<li><a href="#bugs-fixed-in-v34rc1">Bugs fixed in v3.4rc1</a></li>
</ul>
</li>
<li><a href="#v34rc0">v3.4rc0</a><ul>
<li><a href="#bugs-fixed-in-v34rc0">Bugs fixed in v3.4rc0</a></li>
</ul>
</li>
<li><a href="#v34beta0">v3.4beta0</a><ul>
<li><a href="#highlights-of-v34beta0">Highlights of v3.4beta0</a></li>
<li><a href="#features-in-detail-1">Features in detail</a><ul>
<li><a href="#create-sprite3d-asynchronously">Create Sprite3D asynchronously</a></li>
<li><a href="#frustum-culling">Frustum culling</a></li>
<li><a href="#use-less-resources-to-create--uicheckbox-and-uislider">Use less resources to create  ui::CheckBox and ui::Slider</a></li>
<li><a href="#custom-allocators">Custom Allocators</a><ul>
<li><a href="#default-allocator">Default Allocator</a></li>
<li><a href="#general-allocator">General Allocator</a></li>
<li><a href="#fixed-block-allocator">Fixed Block Allocator</a></li>
<li><a href="#pool-allocator">Pool Allocator</a></li>
</ul>
</li>
<li><a href="#implementing-custom-allocators-for-objects">Implementing Custom Allocators for Objects</a></li>
<li><a href="#console-allocator-command-tags-counts-etc">Console (allocator command, tags, counts etc)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h1 id="misc-information">Misc Information</h1>
<ul>
<li><a href="https://github.com/cocos2d/cocos2d-x/blob/cocos2d-x-3.4/CHANGELOG" target="_blank">Full Changelog</a></li>
<li>v3.0 Release Notes can be found here: <a href="https://github.com/cocos2d/cocos2d-x/blob/cocos2d-x-3.0/docs/RELEASE_NOTES.md" target="_blank">v3.0 Release Notes</a></li>
</ul>
<h1 id="requirements">Requirements</h1>
<h2 id="runtime-requirements">Runtime Requirements</h2>
<ul>
<li>Android 2.3 or newer</li>
<li>iOS 5.0 or newer</li>
<li>OS X 10.7 or newer</li>
<li>Windows 7 or newer</li>
<li>Windows Phone 8 or newer</li>
<li>Linux Ubuntu 14.04 or newer</li>
</ul>
<h2 id="compiler-requirements">Compiler Requirements</h2>
<ul>
<li>Xcode 5.1 or newer for iOS or Mac</li>
<li>gcc 4.9 or newer for Linux</li>
<li>ndk-r10c for Android</li>
<li>Visual Studio 2012  or newer for Windows (win32)</li>
<li>Visual Studio 2012  or newer for Windows Phone 8</li>
</ul>
<h2 id="how-to-run-tests">How to run tests</h2>
<h3 id="mac-osx--ios">Mac OSX &amp; iOS</h3>
<ul>
<li>Enter <code>cocos2d-x/build</code> folder, open <code>cocos2d_test.xcodeproj</code></li>
<li>Select <code>iOS</code> or <code>OS X</code> target in scheme toolbar</li>
<li>Click <code>run</code> button</li>
</ul>
<h3 id="android">Android</h3>
<p>You can run the samples...</p>
<p><strong>Using command line:</strong></p>
<pre><code>$ cd cocos2d-x
$ ./setup.py
$ cd build
$ ./android-build.py cpp-empty-test -p 10
$ adb install cocos2d-x/tests/cpp-empty-test/proj.android/bin/CppEmptyTest-debug.apk
</code></pre><p>Then click item on Android device to run tests. Available value of <code>-p</code> is the API level, cocos2d-x supports from level 10.</p>
<p><strong>Using Eclipse:</strong></p>
<pre><code>$ cd cocos2d-x
$ ./setup.py
$ cd build
$ ./android-build.py cpp-empty-test -p 10
</code></pre><p>Then</p>
<ul>
<li>Import cocos2d-x Android project into Eclipse, the path used to import is <code>cocos/2d/platform/android</code></li>
<li>Import <code>cpp-empty-test</code> Android project into Eclipse, the path used to import is <code>tests/cpp-empty-test/proj.android</code></li>
<li>Build <code>cpp-empty-test</code> Android project and run</li>
</ul>
<h3 id="windows">Windows</h3>
<ul>
<li>Enter <code>cocos2d-x/build</code>, and open <code>cocos2d-win32.vs2012.sln</code></li>
<li>Select <code>cpp-empty-test</code> as running target</li>
<li>Click run button</li>
</ul>
<h3 id="linux">Linux</h3>
<pre><code>$ cd cocos2d-x/build
$ ./install-deps-linux.sh
$ cd ../..
</code></pre><p>Then</p>
<pre><code>$ mkdir build
$ cd build
$ cmake ../cocos2d-x
$ make -j4
</code></pre><p>Run</p>
<pre><code>$ cd bin/cpp-empty-test
$ ./cpp-empty-test
</code></pre><h2 id="how-to-start-a-new-game">How to start a new game</h2>
<p>Please refer to this document: <a href="../README.html">ReadMe</a></p>
<h1 id="v34">v3.4</h1>
<h2 id="bugs-fixed-in-v34">Bugs fixed in v3.4</h2>
<ul>
<li>C++: crash on armeabi-v7a arch device which do not support NEON instructions</li>
<li>GLProgram: crash on low end device with no more than 8 attributes support</li>
<li>New audio: game freeze if audio played two many times on android</li>
<li>Node: anchor point has no effects on rotation</li>
<li>More bugs fixed</li>
</ul>
<h1 id="v34rc1">v3.4rc1</h1>
<h2 id="highlights-of-v34rc1">Highlights of v3.4rc1</h2>
<ul>
<li>C++: added CC_USE_CULLING macro to control if enable auto culling or not</li>
<li>FileUtils::fullPathForFilename will return empty string when file can not be found</li>
<li>VertexBuffer&amp;IndexBuffer: allow setting usage(GL_STATIC_DRAW or GL_DYNAMIC_DRAW) in create method</li>
<li>Renderer: 3D rendering support for 2d objects</li>
</ul>
<h2 id="features-in-detail">Features in detail</h2>
<h3 id="3d-rendering-support-for-2d-objects">3D rendering support for 2D objects</h3>
<p>This feature enables Sprite, Label, Particle to be rendered in 3D space by adding them as children of Sprite3D or Billboard. You can achieve effects like blob shadow, 3D particle, Visual damage number popups</p>
<pre><code class="lang-c++"><span class="hljs-keyword">auto</span> billboard = Billboard::create();
<span class="hljs-keyword">auto</span> label = Label::create();
label-&gt;setString(<span class="hljs-string">"+100"</span>);
billboard-&gt;addChild(label);
</code></pre>
<h3 id="culling-is-now-an-options-by-cc_use_culling-macro">Culling is now an options by CC_USE_CULLING macro</h3>
<p>Culling is an important features in cocos2d-x v3.x, but some developer may not want to use culling when all of the scene exist in one screen. A macro <code>CC_USE_CULLING</code> in <code>CCConfig.h</code> can be used to enable or disable culling.</p>
<h2 id="bugs-fixed-in-v34rc1">Bugs fixed in v3.4rc1</h2>
<ul>
<li>DrawNode: fix random crash because of init opengl buffer wrongly</li>
<li>DrawNode: drawPoints() can not set ponit size</li>
<li>EventDispatcher: crash if adding/removing event listeners and dispatching event in event callback function</li>
<li>GLProgramState: may cause GL_INVALID_VALUE error at start up on Android</li>
<li>LUA: 0x80000000 can not be converted by lua_tonumber correctly on some devices</li>
<li>PhysicsBody: can&#39;t get correct position in the same frame of adding PhysicsBody to PhysicsWorld</li>
<li>UI: fix crash when navigation controller is null</li>
</ul>
<h1 id="v34rc0">v3.4rc0</h1>
<h2 id="bugs-fixed-in-v34rc0">Bugs fixed in v3.4rc0</h2>
<ul>
<li>FileUtils::GetData() can not get data on windows</li>
<li>FileUtils::GetData() memory leaks when file size is 0 on windows</li>
<li>Crash if GLProgram log compile or link error info on windows</li>
<li>Assert error exist because of outdated uniforms and attributes in GLProgramState when app come to foreground on android</li>
<li>GL_INVALID_OPERATION error because VAO and VBO is not reset when app come to foreground on android</li>
<li>Update Luajit to v2.0.3, it fix some crash problems on windows</li>
<li>Update libcurl to new version v7.39.0</li>
<li>More bugs fixed</li>
</ul>
<h1 id="v34beta0">v3.4beta0</h1>
<h2 id="highlights-of-v34beta0">Highlights of v3.4beta0</h2>
<h2 id="features-in-detail">Features in detail</h2>
<h3 id="create-sprite3d-asynchronously">Create Sprite3D asynchronously</h3>
<p>It allows to load Sprite3D in another thread so that you can process more logic in the main thread. And it notifies you using a custom callback after creating is finished.</p>
<p><code>modelPath</code> is the file to be loaded, <code>AsyncLoadSprite3DTest::asyncLoad_Callback</code> is the user&#39;s callback function, <code>userParam</code> is the parameter that the callback function is wanted.</p>
<pre><code class="lang-c++">Sprite3D::createAsync(modelPath, CC_CALLBACK_2(AsyncLoadSprite3DTest::asyncLoad_Callback, <span class="hljs-keyword">this</span>), (<span class="hljs-keyword">void</span>*)userParam);
</code></pre>
<p>The callback function is called after loading Sprite3D, the callback function can be something like this,</p>
<pre><code class="lang-c++"><span class="hljs-keyword">void</span> AsyncLoadSprite3DTest::asyncLoad_Callback(Sprite3D* sprite, <span class="hljs-keyword">void</span>* param)
{
    <span class="hljs-comment">//sprite is the loaded sprite</span>
    sprite-&gt;setPosition(point);
    addChild(sprite);
}
</code></pre>
<h3 id="frustum-culling">Frustum culling</h3>
<p>Frustum culling means only the stuff that is inside the frustum is sent to the graphics hardware. To find out more information, please visit <a href="http://en.wikipedia.org/wiki/Frustum" target="_blank">Wikipedia</a>. It can potentially improve the performance of the application since only the vertices that are part of the visible part of the 3D world are kept on the graphics card memory.</p>
<p>Frustum culling is a property of camera, it is enabled by default. And you can use the following to enable or disable the frustum culling,</p>
<pre><code class="lang-c++"><span class="hljs-comment">//the first parameter is enable frustum culling or not, the second means that frustum culling using near and far plan or not.</span>
camera-&gt;enableFrustumCulling(<span class="hljs-keyword">true</span>, <span class="hljs-keyword">true</span>);
</code></pre>
<p>Note that when you can make sure that all the stuff is inside the frustum you can turn off the frustum culling.</p>
<p>For more infomation please reffer to the cpptests/CameraTest</p>
<h3 id="use-less-resources-to-create--uicheckbox-and-uislider">Use less resources to create  ui::CheckBox and ui::Slider</h3>
<p>Now we could use less resources to create  ui::CheckBox and ui::Slider.</p>
<p>To create an ui::CheckBox, we could simply pass the normal state box and active texture.</p>
<pre><code class="lang-cpp">CheckBox* checkBox2 = CheckBox::create(<span class="hljs-string">"cocosui/check_box_normal.png"</span>,
                                              <span class="hljs-string">"cocosui/check_box_active.png"</span>);
</code></pre>
<p>To create an ui::Slider, we could only pass the slider bar texture and normal ball texture.</p>
<pre><code class="lang-cpp">Slider* sliderScale9 = Slider::create(<span class="hljs-string">"cocosui/slidbar.png"</span>, <span class="hljs-string">"cocosui/sliderballnormal.png"</span>);
</code></pre>
<p>If the selected state texture is missing, when user press the widget, the normal texture will scale.</p>
<p>If the disable state texture is missing, when the widget is in disable state, we use gray shader to turn the normal state texture to gray.</p>
<p>The original ui::Button also support the gray shader enhancement.</p>
<h3 id="custom-allocators">Custom Allocators</h3>
<p>in ccConfig.h you can control the custom allocator system with the following defines.</p>
<pre><code class="lang-c++"><span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> CC_ENABLE_ALLOCATOR 1</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> CC_ENABLE_ALLOCATOR_DIAGNOSTICS CC_ENABLE_ALLOCATOR</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> CC_ENABLE_ALLOCATOR_GLOBAL_NEW_DELETE 0</span>

<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> CC_ALLOCATOR_GLOBAL cocos2d::allocator::AllocatorStrategyDefault</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> CC_ALLOCATOR_GLOBAL_NEW_DELETE cocos2d::allocator::AllocatorStrategyGlobalSmallBlock</span>
</code></pre>
<p><strong>CC_ENABLE_ALLOCATOR</strong> turns everything on or off. When set to 0, everything should still build, but all custom allocator code is disabled or removed. This is handled mainly through macros, but if you implement new allocator strategies, you should be aware of, and respect this preprocessor directive.</p>
<p><strong>CC_ENABLE_ALLOCATOR_DIAGNOSTICS</strong> defaults to the same value as <strong>CC_ENABLE_ALLOCATOR</strong>, but setting this to 0 will disable allocator diagnostics via the control panel. Diagnostics have significant overhead, so you definitely want to disable them for production builds.</p>
<p><strong>CC_ENABLE_ALLOCATOR_GLOBAL_NEW_DELETE</strong> enables overriding of the global <strong>new</strong> and <strong>delete</strong> operators. The allocator strategy used can be selected by setting the <strong>CC_ALLOCATOR_GLOBAL_NEW_DELETE</strong> define.</p>
<p><strong>CC_ALLOCATOR_GLOBAL</strong> defines the allocator strategy to use for global allocations. All memory needed by other allocators will use this global allocator, as well as the macros <strong>CC_MALLOC</strong>, <strong>CC_FREE</strong> etc.</p>
<p>Third party libraries that use malloc/free will continue to use the original malloc/free so their memory usage will not be tracked.</p>
<p>Calls to new/delete from shared libraries should work ok provided the library is loaded after the allocator has initialized, which should be the case, unless you load a shared library from a static variable initialization.</p>
<h4 id="default-allocator">Default Allocator</h4>
<p>The default allocator wraps malloc and free and provides an allocator interface that anyone can use to allocate blocks of memory. Tracking is not currently enabled here, but can be added in the future.</p>
<h4 id="general-allocator">General Allocator</h4>
<p>The general allocator provides a series of fixed sized allocators from the smallest allocation size of 4 bytes up to some threshold which currently defaults to 8 Kbytes. Anything larger than this threshold will fallback to the default allocator. See fixed allocators for more details.</p>
<h4 id="fixed-block-allocator">Fixed Block Allocator</h4>
<p>Fixed block allocators provide a memory pool of blocks of fixed size. They are extremely fast since no searching for best fit is required, they can simply pop the first block off a list and return that. Similarly, freeing memory is also extremely fast since they just push the block on the front of the list. Memory is not actually freed, it is kept allocated and track on a free list. It will be possible to reduce the allocated memory by freeing up unused pages of memory from the list.</p>
<h4 id="pool-allocator">Pool Allocator</h4>
<p>Implements a custom fixed block allocator for a specific type. You can override local new/delete for types that are classes or structs using <strong>CC_USE_ALLOCATOR_POOL(pool)</strong>. Additionally, these allocators are configurable in terms of the initial size.</p>
<h3 id="implementing-custom-allocators-for-objects">Implementing Custom Allocators for Objects</h3>
<p>Simply add a static instance of the pool allocator to your class, and use the <strong>CC_USE_ALLOCATOR_POOL</strong> macro to implement operators <strong>new</strong> and <strong>delete</strong> for your class.</p>
<pre><code class="lang-c++">    <span class="hljs-keyword">class</span> SomeClass
    {
    <span class="hljs-keyword">public</span>:

        cocos2d::allocator::AllocatorStrategyPool&lt;SomeClass&gt; _allocator;
        CC_USE_ALLOCATOR_POOL(SomeClass, _allocator);
    };
</code></pre>
<h3 id="console-allocator-command-tags-counts-etc">Console (allocator command, tags, counts etc)</h3>
<p>You can connect to the running app using the console. I.e. <strong>telnet localhost 5678</strong> and issue the <strong>allocator</strong> command to dump out all allocator diagnostic information. One of the useful pieces of information is the highest count for pool allocators. You can plug this value back into the initial size for the allocator to preallocate this number of objects when starting, improving startup speed significantly.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./cocos2d-x_v3.4_release_notes.html" class="navigation navigation-prev " aria-label="Previous page: Cocos2d-x v3.4 中文发布说明"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./cocos2d-x_v3.5_release_notes.html" class="navigation navigation-next " aria-label="Next page: Cocos2d-x v3.5 中文发布说明"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-disqus/plugin.js"></script>
    

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"disqus":{"shortName":"Cocos2d-x"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
